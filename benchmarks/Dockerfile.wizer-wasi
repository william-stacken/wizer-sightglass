FROM debian:bookworm AS builder
WORKDIR /

RUN apt-get update && DEBIAN_FRONTEND=noninteractive apt-get install -y xz-utils wget

RUN wget https://github.com/bytecodealliance/wizer/releases/download/v1.6.0/wizer-v1.6.0-x86_64-linux.tar.xz
RUN tar xvf wizer-v1.6.0-x86_64-linux.tar.xz

FROM debian:bookworm
WORKDIR /
COPY --from=builder /wizer-v1.6.0-x86_64-linux/wizer /

COPY benchmark.wasm .
RUN /wizer --allow-wasi --dir=. -o wizer.benchmark.wasm benchmark.wasm
